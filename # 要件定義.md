# 要件定義

## 目標
DMARCレポートのXMLをZipファイルのまま読み込み、集計してグラフ表示する


## 仕様
DMARCレポートの読み込みは、複数ファイルに対応
fileという名前のフォルダに入っているZipファイルを全部読み込む
Zipファイルの中にZipファイルがある構造のDMARCのレポートにも、対応する。
集計レポートと個別のエラーレポートの両方に、対応する。

グラフ化は、grafana.comを使う

dockerのコンテナを使う。

送信元のIPアドレスで、エラーとPASSを集計して、DMARCのポリシー調整の材料をえることができるようにしたい。

DKIM、SPFそれぞれのPASSとエラーの状況も、集計する、

DMARCレポートの内容を人間が見ても分かるように、各項目を集計する。

個別のエラーのレポートも、内容を分かりやすく表示する。

集計期間は、３０日を限度とする。


# DMARCレポートから得られるもの
集計レポート(Aggregate Report)
集計レポートは、一定期間(通常1日)のメール送信状況を集計したものです。以下のような情報が含まれます:
レポートを送信した組織の情報(受信側サーバーの情報)
対象期間
メールの送信元IPアドレス
受信したメールの数
SPF、DKIMの認証結果
SPF、DKIMのアライメント(ドメインの一致)の結果
参照したDMARCポリシーの内容
DMARCの処理結果(none/quarantine/reject)

個別のエラーレポート(Failure Report/Forensic Report)
個別のエラーレポートは、認証に失敗した個々のメールについての詳細情報を提供します。以下のような情報が含まれます:
送信元IPアドレス
送信者(From)と受信者(To)のメールアドレス
メールの件名
SPF、DKIM、DMARCの認証結果
メールを受信した時刻
メールヘッダーの情報
メール本文の一部(場合によっては全文)